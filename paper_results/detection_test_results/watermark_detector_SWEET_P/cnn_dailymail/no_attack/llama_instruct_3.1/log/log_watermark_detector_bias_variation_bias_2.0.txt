Dataset at data/generated_datasets/cnn_dailymail/no_attack/SWEET_P/llama_instruct_3.1_bias_variation_bias_2.0 exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.7232808737106582
Classifying the articles...
Test metrics:
accuracy: 0.5865717151454363
precision: 1.0
recall: 0.17219709299471156
f1_score: 0.293421660864346
fp_rate: 0.0
tp_rate: 0.17219709299471156
std_accuracy: 0.015788415274331256
std_precision: 0.0
std_recall: 0.01751673105829875
std_f1_score: 0.025476566019142898
std_fp_rate: 0.0
std_tp_rate: 0.01751673105829875
TP: 85.741
TN: 499.071
FP: 0.0
FN: 412.188
roc_auc: 0.9714267893216152
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.00200401 0.00200401 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00601202 0.00601202 0.00601202
 0.00801603 0.00801603 0.00801603 0.00801603 0.00801603 0.00801603
 0.01002004 0.01002004 0.01202405 0.01202405 0.01402806 0.01402806
 0.01603206 0.01603206 0.01603206 0.01803607 0.01803607 0.01803607
 0.01803607 0.01803607 0.01803607 0.02004008 0.02204409 0.02204409
 0.0240481  0.0240481  0.0240481  0.0260521  0.0260521  0.03006012
 0.03006012 0.03607214 0.03607214 0.03607214 0.03807615 0.03807615
 0.03807615 0.03807615 0.04008016 0.04008016 0.04008016 0.04008016
 0.04208417 0.04208417 0.04609218 0.04609218 0.04809619 0.04809619
 0.04809619 0.05210421 0.05210421 0.05611222 0.05611222 0.05611222
 0.05611222 0.06212425 0.06412826 0.06412826 0.06412826 0.06412826
 0.06412826 0.06613226 0.07014028 0.07014028 0.0741483  0.0741483
 0.0761523  0.08016032 0.08016032 0.08216433 0.08617234 0.08817635
 0.08817635 0.08817635 0.09218437 0.09218437 0.09619238 0.09819639
 0.1002004  0.10821643 0.11022044 0.11022044 0.11022044 0.11222445
 0.11222445 0.11222445 0.11623246 0.11823647 0.1242485  0.1242485
 0.12825651 0.13226453 0.13426854 0.13827655 0.13827655 0.14228457
 0.14228457 0.14829659 0.14829659 0.1503006  0.15430862 0.15430862
 0.15631263 0.16032064 0.16232465 0.16232465 0.16633267 0.17034068
 0.17234469 0.18436874 0.18436874 0.18637275 0.18637275 0.19038076
 0.19038076 0.19438878 0.2004008  0.20440882 0.20641283 0.21042084
 0.21643287 0.22044088 0.22244489 0.23046092 0.23647295 0.23647295
 0.23847695 0.24649299 0.24649299 0.24849699 0.24849699 0.250501
 0.250501   0.25250501 0.25450902 0.25450902 0.25651303 0.26252505
 0.26653307 0.26853707 0.26853707 0.27054108 0.28056112 0.28657315
 0.28857715 0.29058116 0.29458918 0.29659319 0.29659319 0.3006012
 0.30861723 0.31663327 0.32264529 0.33266533 0.33867735 0.3507014
 0.35671343 0.36472946 0.36673347 0.37875752 0.37875752 0.38276553
 0.39078156 0.39478958 0.39679359 0.40480962 0.41683367 0.42685371
 0.43086172 0.43286573 0.44088176 0.44288577 0.4509018  0.45290581
 0.46092184 0.46893788 0.47695391 0.48096192 0.48496994 0.48897796
 0.49699399 0.501002   0.501002   0.50501002 0.50901804 0.51703407
 0.51903808 0.52705411 0.52905812 0.56713427 0.57715431 0.58316633
 0.59118236 0.59318637 0.59719439 0.61122244 0.61523046 0.61923848
 0.62124248 0.62124248 0.63126253 0.63527054 0.63727455 0.64328657
 0.64729459 0.65330661 0.65931864 0.66332665 0.66933868 0.67334669
 0.6753507  0.68336673 0.69138277 0.70140281 0.71743487 0.72144289
 0.72344689 0.72745491 0.73947896 0.74348697 0.74549098 0.749499
 0.75951904 0.76352705 0.76953908 0.7755511  0.77955912 0.78957916
 0.79358717 0.7995992  0.80561122 0.80961924 0.81162325 0.81763527
 0.82765531 0.83366733 0.83567134 0.84368737 0.84769539 0.85971944
 0.87174349 0.87975952 0.89178357 0.89579158 0.8997996  0.90581162
 0.91783567 0.92184369 0.94789579 0.95190381 1.        ]
tpr: [0.         0.00200803 0.01004016 0.01405622 0.02008032 0.02811245
 0.04016064 0.04417671 0.04618474 0.0502008  0.05823293 0.062249
 0.06827309 0.07228916 0.07429719 0.07831325 0.08032129 0.08433735
 0.09236948 0.10040161 0.1124498  0.11646586 0.1184739  0.12449799
 0.13453815 0.14056225 0.14859438 0.15461847 0.15863454 0.16666667
 0.17269076 0.18273092 0.18674699 0.19678715 0.20281124 0.20682731
 0.21285141 0.2188755  0.23092369 0.23493976 0.24698795 0.25301205
 0.25903614 0.26305221 0.26907631 0.27710843 0.27911647 0.28313253
 0.28714859 0.29116466 0.29718876 0.30321285 0.30722892 0.31325301
 0.31726908 0.31927711 0.3253012  0.32931727 0.3373494  0.34136546
 0.34738956 0.35542169 0.36144578 0.36546185 0.36947791 0.38353414
 0.3875502  0.3935743  0.39558233 0.39959839 0.40562249 0.40963855
 0.41767068 0.42168675 0.42771084 0.42971888 0.44176707 0.45783133
 0.46385542 0.47188755 0.47389558 0.48192771 0.48594378 0.49196787
 0.50803213 0.51004016 0.51405622 0.51807229 0.52008032 0.52610442
 0.53212851 0.53614458 0.54417671 0.5502008  0.55220884 0.55823293
 0.562249   0.56626506 0.57630522 0.58032129 0.58232932 0.58634538
 0.58835341 0.59437751 0.59638554 0.60441767 0.61044177 0.62048193
 0.62851406 0.63253012 0.64056225 0.64658635 0.65261044 0.65461847
 0.6626506  0.66465863 0.67068273 0.67068273 0.68875502 0.69277108
 0.69277108 0.70080321 0.70281124 0.70682731 0.70883534 0.71485944
 0.7188755  0.72088353 0.72891566 0.73293173 0.73493976 0.73694779
 0.73895582 0.74297189 0.74497992 0.74497992 0.74899598 0.75301205
 0.75702811 0.75903614 0.76907631 0.77309237 0.77309237 0.7751004
 0.7811245  0.78514056 0.78915663 0.79518072 0.79718876 0.79718876
 0.80321285 0.80321285 0.80923695 0.81124498 0.81124498 0.81526104
 0.81927711 0.82329317 0.82730924 0.82931727 0.83534137 0.83935743
 0.84136546 0.84337349 0.84337349 0.84738956 0.84738956 0.84939759
 0.85742972 0.85742972 0.85943775 0.85943775 0.86345382 0.86746988
 0.86947791 0.86947791 0.86947791 0.87349398 0.87751004 0.8815261
 0.88353414 0.88353414 0.88554217 0.88955823 0.88955823 0.8935743
 0.8935743  0.8935743  0.89759036 0.89959839 0.89959839 0.90562249
 0.91164659 0.91365462 0.91365462 0.91566265 0.91566265 0.91566265
 0.91767068 0.91767068 0.91767068 0.92168675 0.92369478 0.92369478
 0.92570281 0.93172691 0.93172691 0.93172691 0.93373494 0.937751
 0.937751   0.937751   0.937751   0.937751   0.94176707 0.94176707
 0.9437751  0.9437751  0.94578313 0.94578313 0.94578313 0.94779116
 0.94779116 0.94779116 0.94779116 0.9497992  0.9497992  0.95180723
 0.95180723 0.95180723 0.95381526 0.95381526 0.95582329 0.95582329
 0.95783133 0.95983936 0.95983936 0.95983936 0.95983936 0.95983936
 0.95983936 0.95983936 0.95983936 0.95983936 0.95983936 0.96385542
 0.96385542 0.96586345 0.96787149 0.96787149 0.96987952 0.96987952
 0.97188755 0.97188755 0.97389558 0.97590361 0.97590361 0.97791165
 0.97791165 0.97791165 0.97991968 0.97991968 0.98192771 0.98192771
 0.98393574 0.98393574 0.98393574 0.98393574 0.98594378 0.98594378
 0.98594378 0.98594378 0.98594378 0.98594378 0.98594378 0.98594378
 0.98594378 0.98594378 0.98795181 0.98795181 0.99196787 0.99196787
 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787
 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787
 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787
 0.99196787 0.99196787 0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.9939759  0.99799197 0.99799197 0.99799197
 0.99799197 0.99799197 0.99799197 0.99799197 0.99799197 0.99799197
 0.99799197 1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.        ]
thresholds: [        inf  5.88888889  5.33349359  5.26685162  5.12569286  5.09324813
  4.98201895  4.92365964  4.81773041  4.78091444  4.71986318  4.71404521
  4.61286039  4.60817688  4.58928518  4.58831468  4.54344111  4.54186872
  4.47834295  4.44446248  4.34121571  4.31800432  4.27617987  4.27239199
  4.18511069  4.18491499  4.12948321  4.12310563  4.09644015  4.03159166
  4.00891863  3.93919299  3.93780765  3.82473155  3.81051178  3.80131556
  3.75        3.73196145  3.67658012  3.63803438  3.5970073   3.57770876
  3.57623736  3.55600356  3.54291389  3.53553391  3.49118974  3.48777249
  3.45699576  3.44656175  3.40168026  3.39549875  3.3624221   3.35658557
  3.34893783  3.30485672  3.3020033   3.29983165  3.298575    3.25493388
  3.25472277  3.25041803  3.25        3.21182027  3.2071349   3.20431048
  3.200922    3.20037877  3.15929297  3.15135439  3.14970394  3.10759438
  3.09838668  3.06412939  3.05423611  3.04800305  3.02243861  3.
  2.98240454  2.96695415  2.96363502  2.94484824  2.92602868  2.9104275
  2.88874152  2.88675135  2.88675135  2.8527989   2.84018779  2.81271975
  2.80989722  2.78994333  2.77777778  2.75        2.73396713  2.72959781
  2.72165527  2.71428571  2.7080128   2.69194639  2.68877448  2.68328157
  2.66789188  2.66053216  2.65581124  2.64575131  2.62950294  2.58770217
  2.56195948  2.54558441  2.54000254  2.51661148  2.49224148  2.49100948
  2.45786409  2.44948974  2.43270072  2.42535625  2.32379001  2.32121944
  2.29415734  2.29227953  2.28600229  2.25488515  2.25170501  2.25
  2.2237818   2.21564684  2.18282063  2.17662696  2.16525095  2.1514115
  2.14179868  2.13808994  2.12132034  2.11111111  2.10859049  2.10042013
  2.0924575   2.08514414  2.07688055  2.06559112  2.04124145  2.03809866
  2.03200203  2.02072594  2.01246118  1.9896995   1.98679854  1.96946386
  1.94145069  1.94098992  1.940285    1.9205532   1.91264943  1.90515869
  1.87082869  1.85714286  1.83532587  1.83254167  1.82036411  1.8057878
  1.78885438  1.78568733  1.78017249  1.77800178  1.76690442  1.75291964
  1.75        1.72328087  1.72189206  1.70940865  1.69774938  1.69245584
  1.68763185  1.67332005  1.66666667  1.66447944  1.64991582  1.6464639
  1.63784605  1.62746694  1.61245155  1.60356745  1.58518785  1.57567719
  1.57242726  1.56524758  1.54919334  1.54281616  1.52153491  1.5109662
  1.5         1.4832397   1.48148749  1.47709789  1.46261427  1.43427433
  1.43207802  1.42693538  1.41004798  1.40840568  1.39497166  1.37799724
  1.37248713  1.36438208  1.34164079  1.33377186  1.32424438  1.31306433
  1.30545982  1.29399328  1.2792043   1.27017059  1.26025208  1.25356634
  1.25        1.22222222  1.21267813  1.20740686  1.19522861  1.19207912
  1.1785113   1.16247639  1.15311332  1.15233192  1.14707867  1.13389342
  1.13227703  1.11803399  1.11631261  1.1055416   1.10431526  1.09454091
  1.08866211  1.08347268  1.03923048  1.02564519  1.01600102  1.01257911
  1.          0.98473193  0.97618706  0.9701425   0.96490128  0.96152395
  0.95618289  0.94280904  0.91766294  0.90582163  0.89625816  0.88345221
  0.8819171   0.87287156  0.86824314  0.8660254   0.86266219  0.85518611
  0.83074716  0.80829038  0.80178373  0.79772404  0.78756153  0.77777778
  0.77459667  0.76834982  0.76200076  0.7592566   0.73854895  0.72586619
  0.70710678  0.69748583  0.67082039  0.66258916  0.64699664  0.60192927
  0.59339083  0.58520574  0.57735027  0.51639778  0.50800051  0.49236596
  0.48507125  0.47809144  0.47140452  0.46499055  0.43643578  0.36650833
  0.3560345   0.35112344  0.34641016  0.34188173  0.33752637  0.32929278
  0.32539569  0.25400025  0.24618298  0.23570226  0.23249528  0.21566555
  0.20851441  0.20412415  0.14586499  0.12216944  0.11704115  0.11547005
  0.11250879  0.11111111  0.10976426  0.         -0.10846523 -0.10976426
 -0.11250879 -0.11396058 -0.11547005 -0.11704115 -0.12403473 -0.12598816
 -0.13018891 -0.15249857 -0.21821789 -0.22086305 -0.2236068  -0.22645541
 -0.22941573 -0.23249528 -0.25400025 -0.25819889 -0.32163376 -0.32539569
 -0.32929278 -0.33752637 -0.34188173 -0.34641016 -0.42008403 -0.42163702
 -0.43133109 -0.4417261  -0.45291081 -0.45883147 -0.48507125 -0.5
 -0.5488213  -0.56254395 -0.56980288 -0.60192927 -0.61084722 -0.6401844
 -0.64699664 -0.6882472  -0.69748583 -0.71713717 -0.72586619 -0.72760688
 -0.77777778 -0.78756153 -0.79772404 -0.83074716 -0.84270097 -0.86266219
 -0.96490128 -0.98787834 -1.09108945 -1.099525   -1.11631261 -1.13227703
 -1.23759669 -1.27017059 -1.43427433 -1.44444444 -3.34664011]
Test metrics at specific given threshold:
accuracy: 0.9036920762286861
precision: 0.9446751943336854
recall: 0.8571463288230261
f1_score: 0.8986967634429268
fp_rate: 0.049970073159232825
tp_rate: 0.8571463288230261
std_accuracy: 0.009382967929295542
std_precision: 0.010295719541531466
std_recall: 0.015318851991920525
std_f1_score: 0.010095109652925349
std_fp_rate: 0.009422370528898471
std_tp_rate: 0.015318851991920525
TP: 426.257
TN: 474.724
FP: 24.963
FN: 71.056
