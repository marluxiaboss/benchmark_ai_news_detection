Dataset at data/generated_datasets/cnn_dailymail/no_attack/SWEET_P/llama_instruct_3.1_bias_variation_bias_20.0 exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.7232808737106582
Classifying the articles...
Test metrics:
accuracy: 0.6747041123370111
precision: 1.0
recall: 0.3502524173218883
f1_score: 0.5184259008303155
fp_rate: 0.0
tp_rate: 0.3502524173218883
std_accuracy: 0.014694941454609036
std_precision: 0.0
std_recall: 0.02134262793367119
std_f1_score: 0.02338663120050914
std_fp_rate: 0.0
std_tp_rate: 0.02134262793367119
TP: 174.83
TN: 497.85
FP: 0.0
FN: 324.32
roc_auc: 0.9877123725362371
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.00200803 0.00200803
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.0060241  0.0060241
 0.0060241  0.0060241  0.00803213 0.00803213 0.00803213 0.00803213
 0.01004016 0.01004016 0.01004016 0.01204819 0.01204819 0.01405622
 0.01405622 0.01606426 0.01606426 0.01807229 0.01807229 0.01807229
 0.02208835 0.02208835 0.02610442 0.02610442 0.02610442 0.03012048
 0.03012048 0.03614458 0.03614458 0.03815261 0.03815261 0.04016064
 0.04016064 0.04618474 0.04618474 0.04819277 0.04819277 0.05220884
 0.0562249  0.0562249  0.062249   0.06425703 0.06626506 0.07028112
 0.07028112 0.07429719 0.07429719 0.07630522 0.08032129 0.08032129
 0.08835341 0.08835341 0.09638554 0.09638554 0.09839357 0.10040161
 0.10843373 0.11044177 0.11044177 0.1124498  0.11646586 0.11646586
 0.1184739  0.12449799 0.12851406 0.13253012 0.13453815 0.13855422
 0.13855422 0.14257028 0.14457831 0.14457831 0.14859438 0.14859438
 0.14859438 0.15060241 0.15461847 0.15461847 0.15662651 0.16064257
 0.1626506  0.16666667 0.17068273 0.17269076 0.18473896 0.18473896
 0.19076305 0.19477912 0.20080321 0.20481928 0.20481928 0.20682731
 0.21084337 0.21686747 0.22088353 0.22289157 0.23092369 0.23694779
 0.23895582 0.24698795 0.24899598 0.24899598 0.25702811 0.26305221
 0.26706827 0.27108434 0.2811245  0.28714859 0.29116466 0.29116466
 0.29518072 0.30120482 0.30923695 0.30923695 0.31726908 0.32329317
 0.33333333 0.33935743 0.34939759 0.35140562 0.35742972 0.36546185
 0.38353414 0.39156627 0.39558233 0.39759036 0.40562249 0.41365462
 0.41365462 0.41767068 0.42771084 0.43172691 0.43373494 0.44176707
 0.4437751  0.45180723 0.45381526 0.46184739 0.46987952 0.47791165
 0.48192771 0.48594378 0.48995984 0.49799197 0.50200803 0.50200803
 0.5060241  0.51004016 0.51807229 0.52008032 0.52811245 0.53012048
 0.56827309 0.57831325 0.58433735 0.59236948 0.59437751 0.59839357
 0.6124498  0.61646586 0.62048193 0.63253012 0.63654618 0.63855422
 0.64457831 0.64859438 0.65461847 0.66064257 0.66465863 0.67068273
 0.6746988  0.67670683 0.68473896 0.69277108 0.70281124 0.7188755
 0.72289157 0.7248996  0.72891566 0.74096386 0.74497992 0.74698795
 0.75100402 0.76104418 0.76506024 0.77108434 0.77710843 0.7811245
 0.79116466 0.79518072 0.80120482 0.80722892 0.81124498 0.81325301
 0.81927711 0.82931727 0.83534137 0.83935743 0.84337349 0.84738956
 0.85943775 0.87148594 0.87951807 0.89156627 0.89558233 0.89959839
 0.90562249 0.91767068 0.92168675 0.94779116 0.95180723 1.        ]
tpr: [0.         0.00200401 0.0240481  0.03206413 0.03406814 0.03807615
 0.04208417 0.04609218 0.06813627 0.07214429 0.10420842 0.10821643
 0.11623246 0.12024048 0.12224449 0.12625251 0.13627255 0.14829659
 0.15631263 0.16232465 0.16633267 0.16833667 0.17635271 0.18236473
 0.18436874 0.19038076 0.2004008  0.20841683 0.21643287 0.22044088
 0.22845691 0.23647295 0.24048096 0.24248497 0.250501   0.25450902
 0.26052104 0.26653307 0.27054108 0.2745491  0.28056112 0.29458918
 0.30260521 0.30661323 0.31062124 0.31262525 0.31663327 0.3246493
 0.33266533 0.33466934 0.34068136 0.34869739 0.3507014  0.36272545
 0.36873747 0.37274549 0.3747495  0.38076152 0.38476954 0.39078156
 0.39478958 0.39679359 0.40480962 0.41683367 0.42284569 0.4248497
 0.44288577 0.4488978  0.45290581 0.45891784 0.46292585 0.46492986
 0.47094188 0.47294589 0.48496994 0.48897796 0.49098196 0.49498998
 0.50501002 0.50901804 0.51503006 0.51903808 0.52104208 0.52705411
 0.53106212 0.53707415 0.54509018 0.5490982  0.5511022  0.55711423
 0.56312625 0.56713427 0.57314629 0.5751503  0.57915832 0.58116232
 0.58917836 0.59118236 0.59519038 0.59719439 0.60521042 0.60721443
 0.61122244 0.61322645 0.61723447 0.62124248 0.62725451 0.63126253
 0.63727455 0.64128257 0.64729459 0.6492986  0.65731463 0.66132265
 0.66533066 0.66733467 0.67134269 0.67334669 0.67935872 0.68136273
 0.68537074 0.68937876 0.69338677 0.69539078 0.6993988  0.71142285
 0.71543086 0.71743487 0.72144289 0.7254509  0.72945892 0.73146293
 0.73547094 0.74148297 0.74549098 0.74749499 0.74749499 0.75551102
 0.76152305 0.76953908 0.7755511  0.77755511 0.78156313 0.78957916
 0.79559118 0.79759519 0.80561122 0.81563126 0.81963928 0.8256513
 0.83767535 0.83967936 0.84569138 0.8496994  0.8496994  0.85170341
 0.86773547 0.86973948 0.86973948 0.87374749 0.87775551 0.87975952
 0.87975952 0.88577154 0.88977956 0.88977956 0.89178357 0.89178357
 0.89378758 0.89779559 0.90180361 0.90180361 0.90581162 0.90981964
 0.90981964 0.91382766 0.91382766 0.91783567 0.91983968 0.92184369
 0.9238477  0.9238477  0.9258517  0.9258517  0.93186373 0.93186373
 0.93587174 0.93587174 0.93787575 0.93787575 0.93987976 0.93987976
 0.93987976 0.94188377 0.94388778 0.94388778 0.94589178 0.94789579
 0.9498998  0.9498998  0.95390782 0.95390782 0.95390782 0.95591182
 0.95591182 0.95791583 0.95791583 0.95991984 0.95991984 0.96192385
 0.96192385 0.96192385 0.96392786 0.96392786 0.96392786 0.96593186
 0.96593186 0.96593186 0.96593186 0.96593186 0.96593186 0.96593186
 0.96793587 0.96793587 0.96793587 0.96993988 0.96993988 0.9739479
 0.9759519  0.9759519  0.9759519  0.97795591 0.97795591 0.97795591
 0.97795591 0.97995992 0.97995992 0.97995992 0.97995992 0.98196393
 0.98196393 0.98196393 0.98196393 0.98196393 0.98396794 0.98396794
 0.98396794 0.98396794 0.98396794 0.98396794 0.98396794 0.98396794
 0.98396794 0.98396794 0.98597194 0.98797595 0.98797595 0.98997996
 0.98997996 0.98997996 0.98997996 0.98997996 0.98997996 0.99198397
 0.99198397 0.99198397 0.99198397 0.99398798 0.99398798 0.99398798
 0.99398798 0.99398798 0.99398798 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.        ]
thresholds: [        inf  6.56532164  5.98630277  5.90839157  5.82998834  5.74196388
  5.66220859  5.66138517  5.497625    5.4160256   5.04714615  5.01996016
  4.93581998  4.91353815  4.90577891  4.88240083  4.79583152  4.71404521
  4.66156183  4.64990555  4.63586325  4.62681396  4.58928518  4.58831468
  4.58257569  4.56460474  4.4812908   4.47834295  4.41741027  4.39109214
  4.36564125  4.34121571  4.33333333  4.33052245  4.31800432  4.30282299
  4.27617987  4.27593055  4.27239199  4.24852916  4.24264069  4.16025147
  4.1576092   4.12948321  4.12310563  4.11111111  4.09644015  4.09314624
  4.06400406  4.04145188  4.03585624  4.03159166  4.02492236  4.
  3.97273315  3.96914328  3.95241972  3.93919299  3.93892771  3.90563289
  3.90006748  3.88290137  3.88057     3.82473155  3.81051178  3.81000381
  3.78725278  3.77123617  3.75277675  3.75        3.73196145  3.71992444
  3.71306952  3.70873523  3.69274473  3.67902314  3.66666667  3.65365657
  3.63803438  3.62222058  3.5970073   3.58568583  3.57957167  3.57770876
  3.55600356  3.54291389  3.50070021  3.5         3.49148624  3.49118974
  3.47439614  3.45699576  3.44656175  3.44123601  3.41396725  3.40168026
  3.39419327  3.37099931  3.35658557  3.35410197  3.34893783  3.34863156
  3.34664011  3.32354886  3.31133089  3.3020033   3.25493388  3.25041803
  3.25        3.2071349   3.20431048  3.200922    3.20037877  3.15929297
  3.15296313  3.15135439  3.14970394  3.11126984  3.10759438  3.10131937
  3.10086836  3.06412939  3.05423611  3.01511345  3.00964633  2.99434495
  2.9938208   2.98240454  2.96695415  2.94484824  2.93987366  2.92856118
  2.92602868  2.9104275   2.89772763  2.88874152  2.88675135  2.84901441
  2.84018779  2.80989722  2.79400279  2.78994333  2.78151795  2.72959781
  2.72165527  2.71746488  2.67261242  2.66789188  2.66053216  2.55744805
  2.52810291  2.47358931  2.46182982  2.42857143  2.42535625  2.393775
  2.33512959  2.32121944  2.29415734  2.28600229  2.2627417   2.25488515
  2.2237818   2.19393102  2.18797487  2.18282063  2.17662696  2.16525095
  2.1514115   2.14179868  2.12132034  2.11111111  2.10090293  2.07688055
  2.04124145  2.03809866  1.9896995   1.98679854  1.97989899  1.96946386
  1.95283366  1.94098992  1.940285    1.91264943  1.87082869  1.83532587
  1.80906807  1.78017249  1.77800178  1.76690442  1.75291964  1.72328087
  1.70940865  1.67748427  1.67332005  1.66666667  1.62746694  1.61245155
  1.60451491  1.58518785  1.57567719  1.57242726  1.56524758  1.54919334
  1.5109662   1.50755672  1.46261427  1.45698559  1.43427433  1.43207802
  1.42693538  1.41004798  1.40840568  1.37799724  1.34164079  1.33630621
  1.33377186  1.32424438  1.30545982  1.29399328  1.2792043   1.27017059
  1.27000127  1.25356634  1.23759669  1.23624508  1.22222222  1.21355975
  1.21267813  1.20740686  1.19522861  1.17953565  1.1785113   1.16247639
  1.15311332  1.14707867  1.13389342  1.13227703  1.11803399  1.11631261
  1.09454091  1.08347268  1.03923048  1.02564519  1.02105494  1.01600102
  1.01257911  1.          0.98473193  0.97618706  0.9701425   0.96490128
  0.95618289  0.94280904  0.90582163  0.89625816  0.86266219  0.85518611
  0.83074716  0.79772404  0.78756153  0.77777778  0.76834982  0.76249285
  0.76200076  0.72586619  0.70710678  0.70014004  0.69748583  0.67082039
  0.66258916  0.64699664  0.62017367  0.60192927  0.59339083  0.58520574
  0.49236596  0.48507125  0.47809144  0.47140452  0.46499055  0.4417261
  0.43759497  0.43643578  0.36650833  0.3560345   0.35112344  0.34641016
  0.34188173  0.33752637  0.32929278  0.32539569  0.25400025  0.24618298
  0.23570226  0.23249528  0.21566555  0.20851441  0.20412415  0.14586499
  0.12216944  0.11704115  0.11547005  0.11250879  0.11111111  0.10976426
  0.         -0.10846523 -0.10976426 -0.11250879 -0.11396058 -0.11547005
 -0.11704115 -0.12403473 -0.12598816 -0.21821789 -0.22086305 -0.2236068
 -0.22645541 -0.22941573 -0.23249528 -0.25400025 -0.25819889 -0.32163376
 -0.32539569 -0.32929278 -0.33752637 -0.34188173 -0.34641016 -0.42008403
 -0.42163702 -0.43133109 -0.4417261  -0.45291081 -0.45883147 -0.48507125
 -0.5        -0.5488213  -0.56254395 -0.56980288 -0.60192927 -0.61084722
 -0.6401844  -0.64699664 -0.6882472  -0.69748583 -0.71713717 -0.72586619
 -0.72760688 -0.77777778 -0.78756153 -0.80829038 -0.83074716 -0.84270097
 -0.86266219 -0.96490128 -0.98787834 -1.09108945 -1.099525   -1.11631261
 -1.13227703 -1.23759669 -1.27017059 -1.43427433 -1.44444444 -3.34664011]
Test metrics at specific given threshold:
accuracy: 0.9449237713139419
precision: 0.949222110396277
recall: 0.9402947000360907
f1_score: 0.9446843863775871
fp_rate: 0.05041703510591353
tp_rate: 0.9402947000360907
std_accuracy: 0.007496382309128729
std_precision: 0.01010647859855982
std_recall: 0.010751243953131793
std_f1_score: 0.007688404511922582
std_fp_rate: 0.009963394812968599
std_tp_rate: 0.010751243953131793
TP: 469.279
TN: 472.81
FP: 25.104
FN: 29.807
