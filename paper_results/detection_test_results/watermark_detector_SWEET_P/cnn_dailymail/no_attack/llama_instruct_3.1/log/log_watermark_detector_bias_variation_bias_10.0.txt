Dataset at data/generated_datasets/cnn_dailymail/no_attack/SWEET_P/llama_instruct_3.1_bias_variation_bias_10.0 exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.7232808737106582
Classifying the articles...
Test metrics:
accuracy: 0.6745356068204614
precision: 1.0
recall: 0.3472199603966157
f1_score: 0.5150920547424755
fp_rate: 0.0
tp_rate: 0.3472199603966157
std_accuracy: 0.015163156485235621
std_precision: 0.0
std_recall: 0.02126548904685256
std_f1_score: 0.02340649539339912
std_fp_rate: 0.0
std_tp_rate: 0.02126548904685256
TP: 172.57
TN: 499.942
FP: 0.0
FN: 324.488
roc_auc: 0.9897002841023412
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.00200401 0.00200401 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00601202 0.00601202 0.00601202 0.00601202
 0.00801603 0.00801603 0.00801603 0.00801603 0.01002004 0.01002004
 0.01202405 0.01202405 0.01402806 0.01402806 0.01803607 0.01803607
 0.01803607 0.01803607 0.02004008 0.02004008 0.0240481  0.0240481
 0.0260521  0.0260521  0.03006012 0.03006012 0.03607214 0.03607214
 0.03807615 0.03807615 0.04008016 0.04008016 0.04008016 0.04609218
 0.04609218 0.0501002  0.05210421 0.05210421 0.05611222 0.05611222
 0.05611222 0.06212425 0.06412826 0.06412826 0.06613226 0.07014028
 0.07014028 0.0741483  0.0741483  0.0761523  0.08016032 0.08016032
 0.08416834 0.08416834 0.08817635 0.08817635 0.09619238 0.09819639
 0.1002004  0.10821643 0.11022044 0.11022044 0.11222445 0.11222445
 0.11623246 0.11823647 0.1242485  0.1242485  0.12825651 0.13226453
 0.13426854 0.14228457 0.14428858 0.14428858 0.1503006  0.15430862
 0.15631263 0.15631263 0.16032064 0.16232465 0.17034068 0.17234469
 0.18436874 0.18637275 0.18837675 0.19038076 0.19438878 0.19438878
 0.2004008  0.20440882 0.20641283 0.21042084 0.21643287 0.22044088
 0.22244489 0.23046092 0.23647295 0.23847695 0.24649299 0.24849699
 0.24849699 0.25651303 0.26252505 0.26653307 0.27054108 0.28056112
 0.28657315 0.28857715 0.29058116 0.29458918 0.3006012  0.30861723
 0.31663327 0.31863727 0.31863727 0.32264529 0.33266533 0.33867735
 0.3507014  0.35671343 0.36472946 0.37675351 0.37675351 0.37875752
 0.37875752 0.38276553 0.39078156 0.39478958 0.39679359 0.40480962
 0.41683367 0.42685371 0.43086172 0.43286573 0.44088176 0.44288577
 0.4509018  0.45290581 0.46092184 0.46893788 0.47695391 0.48096192
 0.48496994 0.48897796 0.49699399 0.50501002 0.50901804 0.51703407
 0.51903808 0.52705411 0.52905812 0.56713427 0.57715431 0.58316633
 0.59118236 0.59318637 0.59719439 0.61122244 0.61523046 0.61923848
 0.63126253 0.63527054 0.63727455 0.64328657 0.64729459 0.65330661
 0.65931864 0.66332665 0.66933868 0.67334669 0.6753507  0.68336673
 0.69138277 0.70140281 0.71743487 0.72144289 0.72344689 0.72745491
 0.73947896 0.74348697 0.74549098 0.749499   0.75951904 0.76352705
 0.76953908 0.7755511  0.77955912 0.78957916 0.79358717 0.7995992
 0.80561122 0.80961924 0.81162325 0.81763527 0.82765531 0.83366733
 0.83567134 0.84368737 0.84769539 0.85971944 0.87174349 0.87975952
 0.89178357 0.89579158 0.8997996  0.90581162 0.91783567 0.92184369
 0.94789579 0.95190381 1.        ]
tpr: [0.         0.00200803 0.03413655 0.03815261 0.04216867 0.04618474
 0.05421687 0.05823293 0.07028112 0.07429719 0.08032129 0.08433735
 0.09437751 0.09839357 0.10240964 0.11445783 0.11646586 0.12248996
 0.12449799 0.13253012 0.13453815 0.14056225 0.14457831 0.14859438
 0.15261044 0.17068273 0.1746988  0.18072289 0.18273092 0.18674699
 0.18875502 0.19277108 0.20281124 0.21084337 0.21485944 0.22289157
 0.22690763 0.23493976 0.23694779 0.24297189 0.24497992 0.25301205
 0.25702811 0.26104418 0.26305221 0.27911647 0.28313253 0.29116466
 0.29317269 0.29718876 0.30321285 0.30722892 0.31124498 0.31325301
 0.32128514 0.32329317 0.3313253  0.33534137 0.34136546 0.34538153
 0.35140562 0.35542169 0.35742972 0.36546185 0.36947791 0.37349398
 0.37751004 0.37951807 0.3875502  0.38955823 0.39558233 0.39959839
 0.40562249 0.41164659 0.42168675 0.43172691 0.43373494 0.4437751
 0.44779116 0.46385542 0.46987952 0.47791165 0.47991968 0.48393574
 0.48594378 0.49799197 0.50200803 0.51405622 0.52208835 0.52811245
 0.53614458 0.54016064 0.54819277 0.5502008  0.55823293 0.562249
 0.56827309 0.57028112 0.57831325 0.58232932 0.59437751 0.59839357
 0.60240964 0.60441767 0.61044177 0.61646586 0.62449799 0.62851406
 0.63453815 0.63654618 0.64859438 0.65662651 0.66064257 0.6626506
 0.6686747  0.67269076 0.68273092 0.68674699 0.69477912 0.70080321
 0.70281124 0.71084337 0.71485944 0.72088353 0.72690763 0.73092369
 0.73293173 0.73694779 0.73895582 0.73895582 0.74698795 0.74698795
 0.75903614 0.76506024 0.77710843 0.7811245  0.78714859 0.79116466
 0.79718876 0.80120482 0.80321285 0.80923695 0.81325301 0.81726908
 0.82128514 0.82329317 0.8253012  0.83935743 0.84738956 0.84939759
 0.85140562 0.85542169 0.85943775 0.86144578 0.86345382 0.86947791
 0.86947791 0.87751004 0.87951807 0.88353414 0.88353414 0.8875502
 0.8935743  0.89959839 0.89959839 0.90160643 0.90160643 0.90562249
 0.90562249 0.90763052 0.90963855 0.91566265 0.91566265 0.91767068
 0.91767068 0.92771084 0.92771084 0.93373494 0.93574297 0.93574297
 0.937751   0.937751   0.94176707 0.94578313 0.94578313 0.9497992
 0.95180723 0.95180723 0.95381526 0.95582329 0.95783133 0.95783133
 0.96184739 0.96184739 0.96586345 0.96586345 0.96586345 0.96987952
 0.96987952 0.97188755 0.97188755 0.97389558 0.97389558 0.97389558
 0.97590361 0.97590361 0.97590361 0.97791165 0.97791165 0.97991968
 0.97991968 0.97991968 0.97991968 0.98192771 0.98192771 0.98192771
 0.98192771 0.98192771 0.98192771 0.98393574 0.98393574 0.98393574
 0.98393574 0.98594378 0.98594378 0.98594378 0.98594378 0.98594378
 0.98594378 0.98594378 0.98795181 0.98795181 0.98795181 0.98995984
 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984
 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984
 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787 0.99196787
 0.99196787 0.9939759  0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.99598394 0.99598394 0.99598394 0.99598394
 0.99598394 0.99598394 0.99598394 0.99598394 0.99799197 0.99799197
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
thresholds: [        inf  6.47609134  5.42709253  5.41736339  5.35614709  5.34739138
  5.25900588  5.25328611  5.14295635  5.12822594  5.0798502   5.06289555
  4.94974747  4.9393917   4.91353815  4.82600483  4.81773041  4.81698971
  4.79868704  4.76460833  4.75556354  4.75        4.71404521  4.67238363
  4.66156183  4.55661188  4.54186872  4.52910814  4.52026944  4.5033321
  4.50033466  4.5         4.43129368  4.41741027  4.39566139  4.39109214
  4.37095678  4.35889894  4.35464843  4.33052245  4.31800432  4.27593055
  4.24852916  4.24264069  4.22521704  4.18491499  4.1576092   4.1537358
  4.14613991  4.13118224  4.12310563  4.09644015  4.09314624  4.0824829
  4.06400406  4.06377727  4.04145188  4.03585624  4.03159166  4.00693843
  3.98862018  3.97273315  3.96914328  3.95241972  3.93892771  3.9103592
  3.90563289  3.90006748  3.88057     3.87298335  3.84507677  3.82473155
  3.80131556  3.78725278  3.74165739  3.73196145  3.71992444  3.71306952
  3.70873523  3.69274473  3.67902314  3.67658012  3.67065174  3.65365657
  3.64067926  3.62827556  3.62222058  3.5970073   3.57957167  3.57142857
  3.55600356  3.53860695  3.5151006   3.50070021  3.5         3.48777249
  3.48742916  3.45699576  3.44656175  3.41396725  3.35658557  3.34893783
  3.34863156  3.34664011  3.32820118  3.3020033   3.298575    3.25493388
  3.25041803  3.25        3.200922    3.15929297  3.15296313  3.15135439
  3.11769145  3.10759438  3.09838668  3.06412939  3.04800305  3.04642442
  3.02243861  3.          2.99434495  2.93987366  2.92602868  2.9104275
  2.89772763  2.88874152  2.88675135  2.88675135  2.8527989   2.84018779
  2.78151795  2.75        2.68877448  2.68328157  2.60985072  2.60472943
  2.55555556  2.52810291  2.51661148  2.5         2.49224148  2.47358931
  2.45786409  2.44948974  2.42535625  2.35665996  2.32379001  2.32121944
  2.29415734  2.28733121  2.28600229  2.25        2.2237818   2.19393102
  2.18282063  2.17662696  2.16525095  2.1514115   2.11111111  2.10859049
  2.10090293  2.07688055  2.06559112  2.0465595   2.03200203  2.
  1.9896995   1.98776747  1.96946386  1.94145069  1.94098992  1.940285
  1.91264943  1.85714286  1.83532587  1.80739223  1.8057878   1.78017249
  1.77800178  1.73205081  1.72328087  1.72189206  1.70940865  1.69774938
  1.69705627  1.67332005  1.66666667  1.63299316  1.62746694  1.61245155
  1.58820278  1.58518785  1.57567719  1.57242726  1.56524758  1.54919334
  1.52752523  1.52400152  1.5109662   1.5         1.46261427  1.43427433
  1.43207802  1.42693538  1.41004798  1.38675049  1.37799724  1.36082763
  1.34164079  1.33377186  1.32424438  1.31306433  1.30545982  1.29399328
  1.2792043   1.25356634  1.23759669  1.2344268   1.20740686  1.19522861
  1.1785113   1.1717002   1.16247639  1.15311332  1.13389342  1.13227703
  1.11803399  1.1055416   1.099525    1.09454091  1.08347268  1.06904497
  1.03923048  1.02564519  1.01600102  1.01257911  1.          0.98473193
  0.97618706  0.9701425   0.96490128  0.95618289  0.94280904  0.90582163
  0.90453403  0.86266219  0.85518611  0.83074716  0.79772404  0.78756153
  0.77777778  0.77459667  0.76834982  0.76200076  0.72586619  0.70710678
  0.69748583  0.6882472   0.68680282  0.67082039  0.66258916  0.64699664
  0.60192927  0.59339083  0.58520574  0.53605627  0.53452248  0.51639778
  0.50800051  0.49236596  0.48507125  0.47809144  0.47140452  0.46499055
  0.43643578  0.36650833  0.3560345   0.35112344  0.34641016  0.34188173
  0.33752637  0.32929278  0.32539569  0.25400025  0.24618298  0.23570226
  0.23249528  0.21566555  0.20851441  0.12216944  0.11704115  0.11547005
  0.11250879  0.11111111  0.10976426  0.         -0.10846523 -0.10976426
 -0.11250879 -0.11396058 -0.11547005 -0.11704115 -0.12403473 -0.12598816
 -0.21821789 -0.22086305 -0.2236068  -0.22645541 -0.22941573 -0.23249528
 -0.25400025 -0.25819889 -0.32163376 -0.32539569 -0.32929278 -0.33752637
 -0.34188173 -0.34641016 -0.42008403 -0.42163702 -0.43133109 -0.4417261
 -0.45291081 -0.45883147 -0.48507125 -0.5        -0.5488213  -0.56254395
 -0.56980288 -0.60192927 -0.61084722 -0.6401844  -0.64699664 -0.6882472
 -0.69748583 -0.71713717 -0.72586619 -0.72760688 -0.77777778 -0.78756153
 -0.79772404 -0.83074716 -0.84270097 -0.86266219 -0.96490128 -0.98787834
 -1.09108945 -1.099525   -1.11631261 -1.13227703 -1.23759669 -1.27017059
 -1.43427433 -1.44444444 -3.34664011]
Test metrics at specific given threshold:
accuracy: 0.9437602808425276
precision: 0.9490884961847004
recall: 0.937685532219034
f1_score: 0.9432951991073713
fp_rate: 0.05015980872332672
tp_rate: 0.937685532219034
std_accuracy: 0.007410462501920089
std_precision: 0.010238408851089566
std_recall: 0.011050098533515984
std_f1_score: 0.007726335114975622
std_fp_rate: 0.009940443283451336
std_tp_rate: 0.011050098533515984
TP: 466.893
TN: 474.036
FP: 25.041
FN: 31.03
