Dataset at data/generated_datasets/cnn_dailymail/no_attack/SWEET_P/llama_instruct_3.1_bias_variation_bias_5.0 exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.7232808737106582
Classifying the articles...
Test metrics:
accuracy: 0.6805336008024071
precision: 1.0
recall: 0.36058050244871254
f1_score: 0.5296802234108454
fp_rate: 0.0
tp_rate: 0.36058050244871254
std_accuracy: 0.014640769090051702
std_precision: 0.0
std_recall: 0.021281675815218653
std_f1_score: 0.022955300443178554
std_fp_rate: 0.0
std_tp_rate: 0.021281675815218653
TP: 179.606
TN: 498.886
FP: 0.0
FN: 318.508
roc_auc: 0.9893763430475409
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.00200401
 0.00200401 0.00200401 0.00200401 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802 0.00400802
 0.00400802 0.00400802 0.00601202 0.00601202 0.00601202 0.00601202
 0.00601202 0.00601202 0.00801603 0.00801603 0.00801603 0.01002004
 0.01002004 0.01002004 0.01002004 0.01202405 0.01202405 0.01402806
 0.01402806 0.01603206 0.01603206 0.01803607 0.01803607 0.02004008
 0.0260521  0.03006012 0.03006012 0.03607214 0.03607214 0.03807615
 0.03807615 0.04008016 0.04008016 0.04208417 0.04208417 0.04609218
 0.04609218 0.04809619 0.0501002  0.05210421 0.05611222 0.05611222
 0.06212425 0.06412826 0.06613226 0.0741483  0.0761523  0.08016032
 0.08817635 0.08817635 0.09619238 0.1002004  0.10821643 0.11222445
 0.11623246 0.11823647 0.1242485  0.12825651 0.13226453 0.13426854
 0.14228457 0.1503006  0.15430862 0.15430862 0.15631263 0.16032064
 0.16232465 0.17034068 0.17234469 0.18436874 0.18436874 0.19038076
 0.19438878 0.2004008  0.20440882 0.20641283 0.21042084 0.21643287
 0.22044088 0.22244489 0.23046092 0.23647295 0.23847695 0.24649299
 0.24849699 0.24849699 0.25651303 0.26252505 0.26653307 0.26653307
 0.27054108 0.28056112 0.28657315 0.29058116 0.29458918 0.3006012
 0.30861723 0.31663327 0.31863727 0.31863727 0.32264529 0.33266533
 0.33867735 0.3507014  0.35671343 0.36472946 0.38276553 0.39078156
 0.39478958 0.39679359 0.40480962 0.41683367 0.42685371 0.43086172
 0.43286573 0.44088176 0.44288577 0.4509018  0.45290581 0.46092184
 0.46893788 0.47695391 0.48096192 0.48496994 0.48897796 0.49699399
 0.501002   0.501002   0.50501002 0.50901804 0.51703407 0.51903808
 0.52705411 0.52905812 0.56713427 0.57715431 0.58316633 0.59118236
 0.59318637 0.59719439 0.61122244 0.61523046 0.61923848 0.61923848
 0.62124248 0.62124248 0.63126253 0.63527054 0.63727455 0.64328657
 0.64729459 0.65330661 0.65931864 0.66332665 0.66933868 0.67334669
 0.6753507  0.68336673 0.69138277 0.70140281 0.71743487 0.72144289
 0.72344689 0.72745491 0.73947896 0.74348697 0.74549098 0.749499
 0.75951904 0.76352705 0.76953908 0.7755511  0.77955912 0.78957916
 0.79358717 0.7995992  0.80561122 0.80961924 0.81162325 0.81763527
 0.82765531 0.83366733 0.83567134 0.84368737 0.84769539 0.85971944
 0.87174349 0.87975952 0.89178357 0.89579158 0.8997996  0.90581162
 0.91783567 0.92184369 0.94789579 0.95190381 1.        ]
tpr: [0.         0.00401606 0.01405622 0.02208835 0.04417671 0.04819277
 0.05421687 0.05823293 0.062249   0.06626506 0.06827309 0.07630522
 0.07831325 0.08232932 0.09036145 0.09437751 0.1064257  0.1124498
 0.11646586 0.12048193 0.12248996 0.12650602 0.13453815 0.13855422
 0.14257028 0.14859438 0.15060241 0.15863454 0.16465863 0.17068273
 0.1746988  0.17670683 0.18273092 0.19076305 0.19477912 0.19879518
 0.21285141 0.2188755  0.22289157 0.22690763 0.22891566 0.23293173
 0.24096386 0.24899598 0.25502008 0.26706827 0.27108434 0.2751004
 0.27911647 0.28313253 0.29116466 0.29317269 0.30120482 0.30923695
 0.31726908 0.32128514 0.32730924 0.3313253  0.33333333 0.34136546
 0.34337349 0.34939759 0.35140562 0.35542169 0.35742972 0.36144578
 0.36546185 0.36947791 0.37148594 0.37951807 0.38353414 0.39156627
 0.39959839 0.40361446 0.41164659 0.41767068 0.42369478 0.43373494
 0.43574297 0.4437751  0.4497992  0.45582329 0.45983936 0.46184739
 0.47389558 0.47791165 0.47991968 0.48795181 0.4939759  0.5
 0.51204819 0.51405622 0.52008032 0.53614458 0.54417671 0.5502008
 0.55823293 0.562249   0.56827309 0.57831325 0.58232932 0.59036145
 0.60240964 0.61044177 0.61646586 0.62449799 0.62650602 0.63052209
 0.63453815 0.64257028 0.64457831 0.65662651 0.65863454 0.6626506
 0.66465863 0.6686747  0.67068273 0.67670683 0.68473896 0.69076305
 0.69879518 0.70883534 0.71285141 0.71485944 0.7188755  0.72088353
 0.7248996  0.72690763 0.73293173 0.73493976 0.73895582 0.74096386
 0.74698795 0.75100402 0.75702811 0.75903614 0.76305221 0.76305221
 0.76506024 0.76907631 0.77108434 0.7751004  0.77911647 0.7811245
 0.78915663 0.79317269 0.80522088 0.81526104 0.81927711 0.8253012
 0.82931727 0.83333333 0.8373494  0.83935743 0.85542169 0.86144578
 0.86546185 0.87148594 0.87751004 0.88554217 0.89156627 0.8935743
 0.89959839 0.90160643 0.90361446 0.91164659 0.91566265 0.91566265
 0.91767068 0.92168675 0.92369478 0.92369478 0.92771084 0.92771084
 0.93172691 0.937751   0.93975904 0.93975904 0.9437751  0.94578313
 0.94578313 0.94578313 0.94779116 0.94779116 0.9497992  0.9497992
 0.95582329 0.95582329 0.95983936 0.95983936 0.96184739 0.96184739
 0.96385542 0.96385542 0.96586345 0.96586345 0.96586345 0.96987952
 0.96987952 0.97188755 0.97188755 0.97188755 0.97188755 0.97188755
 0.97188755 0.97389558 0.97389558 0.97389558 0.97389558 0.97389558
 0.97389558 0.97389558 0.97389558 0.97389558 0.97389558 0.97389558
 0.97389558 0.97389558 0.97389558 0.97791165 0.97791165 0.97791165
 0.97791165 0.97791165 0.97791165 0.97791165 0.97991968 0.97991968
 0.97991968 0.97991968 0.97991968 0.98192771 0.98192771 0.98393574
 0.98393574 0.98393574 0.98393574 0.98393574 0.98393574 0.98393574
 0.98393574 0.98594378 0.98594378 0.98594378 0.98594378 0.98995984
 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984 0.98995984
 0.98995984 0.98995984 0.98995984 0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.9939759  0.9939759  0.9939759  0.9939759  0.9939759
 0.9939759  0.99598394 0.99598394 0.99598394 0.99598394 0.99598394
 0.99598394 0.99598394 0.99598394 0.99598394 0.99598394 0.99598394
 0.99598394 0.99598394 0.99598394 0.99598394 0.99598394 0.99799197
 0.99799197 1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.        ]
thresholds: [        inf  6.12825877  5.73794829  5.73501621  5.35614709  5.26685162
  5.19615242  5.17659168  5.16984262  5.16551446  5.15892022  5.09324813
  5.08000508  5.0798502   5.04714615  5.01996016  4.98201895  4.96521232
  4.93581998  4.90577891  4.90098029  4.90030479  4.83787797  4.83735465
  4.79868704  4.78091444  4.76460833  4.75        4.69574275  4.69504827
  4.67747666  4.67238363  4.66156183  4.62844847  4.61286039  4.60817688
  4.52910814  4.52026944  4.5         4.4812908   4.47834295  4.47213595
  4.39109214  4.38784281  4.36564125  4.30282299  4.30265273  4.27617987
  4.27593055  4.25        4.21350486  4.20180585  4.18511069  4.1576092
  4.1537358   4.12948321  4.09314624  4.0824829   4.07619732  4.06400406
  4.06377727  4.04145188  4.03585624  4.03159166  4.01321347  4.00693843
  3.98862018  3.97273315  3.96914328  3.95241972  3.93892771  3.90006748
  3.88057     3.84974192  3.84507677  3.82473155  3.80131556  3.78725278
  3.78075623  3.77547842  3.77123617  3.75277675  3.75        3.74165739
  3.71992444  3.71306952  3.71279007  3.69274473  3.67902314  3.67065174
  3.65365657  3.64067926  3.63803438  3.60555128  3.5970073   3.57623736
  3.55600356  3.53277787  3.5151006   3.5         3.48742916  3.45699576
  3.44166681  3.4340141   3.3968311   3.39549875  3.39419327  3.39411255
  3.34893783  3.34664011  3.32820118  3.298575    3.26598632  3.26275491
  3.25472277  3.25041803  3.21182027  3.20037877  3.15929297  3.15296313
  3.14970394  3.09838668  3.06412939  3.05085108  3.04800305  3.04642442
  3.03773733  3.01931765  3.          2.99434495  2.96695415  2.95419578
  2.94484824  2.93987366  2.9104275   2.89772763  2.88874152  2.88675135
  2.88457184  2.86854866  2.8527989   2.84018779  2.83163942  2.82842712
  2.80989722  2.78994333  2.72165527  2.7080128   2.67261242  2.66789188
  2.66053216  2.60985072  2.60472943  2.5924757   2.51661148  2.49100948
  2.45786409  2.42857143  2.42535625  2.38047614  2.36351579  2.35665996
  2.32379001  2.30940108  2.29415734  2.25488515  2.25170501  2.2237818
  2.21880078  2.21564684  2.21321149  2.18282063  2.17662696  2.16525095
  2.1514115   2.14179868  2.13808994  2.11111111  2.07688055  2.06559112
  1.9896995   1.96946386  1.95283366  1.94098992  1.9205532   1.91264943
  1.85996222  1.83532587  1.8057878   1.78885438  1.78568733  1.78017249
  1.77800178  1.76690442  1.73205081  1.72328087  1.70940865  1.69245584
  1.67332005  1.66666667  1.62746694  1.58518785  1.57242726  1.56524758
  1.5109662   1.5         1.46261427  1.43207802  1.42693538  1.37799724
  1.34164079  1.33377186  1.32424438  1.30545982  1.29399328  1.2792043
  1.25356634  1.20740686  1.19522861  1.17953565  1.1785113   1.16247639
  1.15311332  1.13389342  1.13227703  1.11803399  1.11631261  1.09454091
  1.08347268  1.03923048  1.02564519  1.01600102  1.01257911  1.
  0.98473193  0.97618706  0.9701425   0.96490128  0.95618289  0.94280904
  0.90582163  0.88465174  0.86266219  0.85518611  0.83074716  0.81649658
  0.79772404  0.78756153  0.77777778  0.76834982  0.76200076  0.72586619
  0.70710678  0.69748583  0.6882472   0.68680282  0.67082039  0.66258916
  0.64699664  0.60192927  0.59339083  0.58520574  0.49236596  0.48507125
  0.47809144  0.47140452  0.46499055  0.43643578  0.36650833  0.3560345
  0.35112344  0.34641016  0.34188173  0.33752637  0.32929278  0.32539569
  0.25400025  0.24618298  0.23570226  0.23249528  0.21566555  0.20851441
  0.20412415  0.14586499  0.12216944  0.11704115  0.11547005  0.11250879
  0.11111111  0.10976426  0.         -0.10846523 -0.10976426 -0.11250879
 -0.11396058 -0.11547005 -0.11704115 -0.12403473 -0.12598816 -0.12803688
 -0.13018891 -0.14002801 -0.21821789 -0.22086305 -0.2236068  -0.22645541
 -0.22941573 -0.23249528 -0.25400025 -0.25819889 -0.32163376 -0.32539569
 -0.32929278 -0.33752637 -0.34188173 -0.34641016 -0.42008403 -0.42163702
 -0.43133109 -0.4417261  -0.45291081 -0.45883147 -0.48507125 -0.5
 -0.5488213  -0.56254395 -0.56980288 -0.60192927 -0.61084722 -0.6401844
 -0.64699664 -0.6882472  -0.69748583 -0.71713717 -0.72586619 -0.72760688
 -0.77777778 -0.78756153 -0.79772404 -0.83074716 -0.84270097 -0.86266219
 -0.96490128 -0.98787834 -1.09108945 -1.099525   -1.11631261 -1.13227703
 -1.23759669 -1.27017059 -1.43427433 -1.44444444 -3.34664011]
Test metrics at specific given threshold:
accuracy: 0.9580190571715146
precision: 0.9504140461292362
recall: 0.9664426747339838
f1_score: 0.9583238941496789
fp_rate: 0.05037390420372033
tp_rate: 0.9664426747339838
std_accuracy: 0.006480243699771243
std_precision: 0.009641018471562396
std_recall: 0.007980023689891648
std_f1_score: 0.006549791149427686
std_fp_rate: 0.00966263520704735
std_tp_rate: 0.007980023689891648
TP: 481.658
TN: 473.487
FP: 25.123
FN: 16.732
